<!DOCTYPE html>
<html lang="es">
<head>
	<title>E-commerce - Inicio</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
	<link rel="stylesheet" href="css/styles.css">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" />
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Outfit:400,500,600,700,800,900&subset=latin" />
	<link rel="icon" type="image/png" sizes="48x48" href="./favicon.png" />
</head>

<body>
	<!-- Placeholder para el header reutilizable -->
    <div id="header-placeholder"></div>

	<!-- Placeholder para el carrito reutilizable -->
    <div id="cart-placeholder"></div>
	<main>
		<section class="carrusel">
            <div id="productCarousel" class="carousel slide" data-bs-ride="carousel" data-bs-interval="5000">
                <div class="carousel-indicators">
                  <button type="button" data-bs-target="#productCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                  <button type="button" data-bs-target="#productCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
                  <button type="button" data-bs-target="#productCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
                </div>
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img src="https://imagenes.compragamer.com/bannerPrincipal/DC_20251003172358_rJTbWwMS.jpg" class="d-block carousel-image-custom" alt="Producto 1">
                    </div>
                    <div class="carousel-item">
                        <img src="https://imagenes.compragamer.com/bannerPrincipal/DC_20251006135600_IY108xqx.jpg" class="d-block carousel-image-custom" alt="Producto 2">
                    </div>
                    <div class="carousel-item">
                        <img src="https://imagenes.compragamer.com/bannerPrincipal/DC_20251009174225_3JrGhCFq.jpg" class="d-block carousel-image-custom" alt="Producto 3">
                    </div>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#productCarousel" data-bs-slide="prev">
                  <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                  <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#productCarousel" data-bs-slide="next">
                  <span class="carousel-control-next-icon" aria-hidden="true"></span>
                  <span class="visually-hidden">Next</span>
                </button>
              </div>
        </section>
		<!-- Sección de Productos -->
		<section class="py-5">
			<div class="container-wide">
				<div class="row gx-5">
					<!-- Columna de Filtros Fija -->
					<div class="col-lg-3">
						<div class="filters-sidebar">
							<h4 class="mb-4">Filtros</h4>
							<div class="accordion accordion-flush" id="accordionFlushExample">
								<!-- Categorias -->
								<div class="accordion-item">
									<h2 class="accordion-header">
										<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="false" aria-controls="panelsStayOpen-collapseOne">
											Categorias
										</button>
									</h2>
									<div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse px-4 py-2">
										<!-- Las categorías se cargarán aquí dinámicamente -->
										<div id="category-filters-container">
											<p class="text-muted small">Cargando...</p>
										</div>
									</div>
								</div>
								<!-- Marcas -->
								<div class="accordion-item">
									<h2 class="accordion-header">
										<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="false" aria-controls="panelsStayOpen-collapseTwo">
											Marcas
										</button>
									</h2>
									<div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse px-4 py-2">
										<!-- Las marcas se cargarán aquí dinámicamente -->
										<div id="brand-filters-container">
											<p class="text-muted small">Cargando...</p>
										</div>
									</div>
								</div>
								<!-- Precio -->
								<div class="accordion-item">
									<h2 class="accordion-header">
										<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseThree" aria-expanded="false" aria-controls="panelsStayOpen-collapseThree">
											Precio
										</button>
									</h2>
									<div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse p-2">
										<div class="d-flex gap-2">
											<div class="input-group">
												<span class="input-group-text">$</span>
												<input type="text" class="form-control" aria-label="Precio minimo" placeholder="Minimo" id="minprice-input"> 
											</div>
											<div class="input-group">
												<span class="input-group-text">$</span>
												<input type="text" class="form-control" aria-label="Precio maximo" placeholder="Maximo" id="maxprice-input"> 
											</div>
										</div>
									</div>	
								</div>
							</div>
							<!-- Boton de aplicar filtros -->
							<div class="d-grid gap-2 mt-4">
								<button class="btn btn-primary" type="button" id="apply-filters-button" onclick="obtenerFiltros()">
									Aplicar Filtros
								</button>
								<button class="btn btn-secondary" type="button" id="clear-filters-button" onclick="limpiarFiltros()">
									Limpiar Filtros
								</button>
							</div>
						</div>
					</div>

					<!-- Columna de Productos -->
					<div class="col-lg-9">
						<div class="mb-5 text-center">
							<h2 class="font-heading fs-7">Nuestros Productos</h2>
							<p class="text-secondary-dark">Explora nuestro catálogo de productos</p>
						</div>
						<div id="product-grid" class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4">
							<!-- Las tarjetas de productos se insertarán aquí con JavaScript -->
						</div>
					</div>
				</div>
			</div>
		</section>
		
		<section class="row">
            <div class="flex-container">
                <div class="container-item">
                    <div class="icon-container">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free v7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M512 176C520.8 176 528 183.2 528 192L528 224L112 224L112 192C112 183.2 119.2 176 128 176L512 176zM528 288L528 448C528 456.8 520.8 464 512 464L128 464C119.2 464 112 456.8 112 448L112 288L528 288zM128 128C92.7 128 64 156.7 64 192L64 448C64 483.3 92.7 512 128 512L512 512C547.3 512 576 483.3 576 448L576 192C576 156.7 547.3 128 512 128L128 128zM144 408C144 421.3 154.7 432 168 432L216 432C229.3 432 240 421.3 240 408C240 394.7 229.3 384 216 384L168 384C154.7 384 144 394.7 144 408zM288 408C288 421.3 298.7 432 312 432L376 432C389.3 432 400 421.3 400 408C400 394.7 389.3 384 376 384L312 384C298.7 384 288 394.7 288 408z"/></svg>
                    </div>
                    <div class="text-container">
                        <h2>Hasta 12 cuotas</h2>
                        <p>abonando con tarjetas de crédito</p>
                    </div>
                </div>
                <div class="container-item">
                    <div class="icon-container">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free v7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M96 144C87.2 144 80 151.2 80 160L80 448C80 456.8 87.2 464 96 464L99.3 464C109.7 427.1 143.7 400 184 400C224.3 400 258.2 427.1 268.7 464L371.3 464C376.2 446.6 386.4 431.3 400 420.1L400 160C400 151.2 392.8 144 384 144L96 144zM99.3 512L96 512C60.7 512 32 483.3 32 448L32 160C32 124.7 60.7 96 96 96L384 96C419.3 96 448 124.7 448 160L448 192L503.4 192C520.4 192 536.7 198.7 548.7 210.7L589.3 251.3C601.3 263.3 608 279.6 608 296.6L608 448C608 483.3 579.3 512 544 512L540.7 512C530.3 548.9 496.3 576 456 576C415.7 576 381.8 548.9 371.3 512L268.7 512C258.3 548.9 224.3 576 184 576C143.7 576 109.8 548.9 99.3 512zM448 320L560 320L560 296.6C560 292.4 558.3 288.3 555.3 285.3L514.7 244.7C511.7 241.7 507.6 240 503.4 240L448 240L448 320zM448 368L448 400.4C450.6 400.2 453.3 400 456 400C496.3 400 530.2 427.1 540.7 464L544 464C552.8 464 560 456.8 560 448L560 368L448 368zM184 528C206.1 528 224 510.1 224 488C224 465.9 206.1 448 184 448C161.9 448 144 465.9 144 488C144 510.1 161.9 528 184 528zM456 528C478.1 528 496 510.1 496 488C496 465.9 478.1 448 456 448C433.9 448 416 465.9 416 488C416 510.1 433.9 528 456 528z"/></svg>
                    </div>
                    <div class="text-container">
                        <h2>Hasta 12 cuotas</h2>
                        <p>abonando con tarjetas de crédito</p>
                    </div>
                </div>
                <div class="container-item">
                    <div class="icon-container">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free v7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M320 64C324.6 64 329.2 65 333.4 66.9L521.8 146.8C543.8 156.1 560.2 177.8 560.1 204C559.6 303.2 518.8 484.7 346.5 567.2C329.8 575.2 310.4 575.2 293.7 567.2C121.3 484.7 80.6 303.2 80.1 204C80 177.8 96.4 156.1 118.4 146.8L306.7 66.9C310.9 65 315.4 64 320 64z"/></svg>
                    </div>
                    <div class="text-container">
                        <h2>Garantía oficial</h2>
                        <p>de 36 meses en todos los productos</p>
                    </div>
                </div>
            </div>
        </section>

	</main>
	

	<!-- Placeholder para el footer reutilizable -->
    <div id="footer-placeholder"></div>

	<!-- Scripts -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
	<script src="js/header.js"></script>
	<script src="js/cart.js"></script>
	<script src="js/footer.js"></script>
	<script src="js/burguer-button.js"></script>
	<script src="js/logout.js"></script>
	<script src="js/api.js"></script>
	<script>
		document.addEventListener('DOMContentLoaded', function() {
			loadFilterOptions(); // Cargar categorías y marcas en los filtros
			// Comprueba si hay un término de búsqueda en la URL
            const urlParams = new URLSearchParams(window.location.search);
            const searchTerm = urlParams.get('search');
            const categoryId = urlParams.get('category_id');

            if (categoryId) {
                // Si hay un ID de categoría, filtramos por él
                filtrarProductos({ categoryID: categoryId, selectedBrands: [], minPrice: null, maxPrice: null });
            } else {
                // De lo contrario, hacemos una búsqueda normal o cargamos todos
                fetchProducts(searchTerm || '');
            }
		});

		function limpiarFiltros() {
			// Limpia los inputs de radio, checkboxes y precios
			document.querySelectorAll('input[name="category"]').forEach(radio => radio.checked = false);
			document.querySelectorAll('#brand-filters-container input[type="checkbox"]').forEach(checkbox => checkbox.checked = false);
			document.getElementById('minprice-input').value = '';
			document.getElementById('maxprice-input').value = '';
			fetchProducts(); // Vuelve a cargar todos los productos
		}
	</script>
</body>
</html>
